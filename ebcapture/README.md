# EBook 캡쳐 프로그램 (ebcapture)

Windows/Mac 환경에서 전자책 리더 프로그램의 화면을 자동으로 캡쳐하여 이미지 및 PDF 파일로 변환하는 도구입니다.

## 기능

- ✅ 실행 중인 전자책 프로그램 자동 감지
- ✅ CLI 기반 사용자 인터페이스
- ✅ 지정된 페이지 수만큼 자동 캡쳐
- ✅ 자동 페이지 넘김 (키보드 시뮬레이션)
- ✅ 캡쳐된 이미지들을 PDF로 통합
- ✅ 진행 상황 실시간 표시

## 지원 플랫폼

- Windows 10+
- macOS 10.14+ (부분 지원)

## 지원 전자책 프로그램

- 알라딘 eBook
- 리디북스 (RidiBooks)
- Yes24 eBook
- 크레마
- 교보문고
- 밀리의 서재
- Adobe Digital Editions
- Kindle
- Calibre
- 기타 PDF/EPUB 리더

## 설치 및 빌드

### 사전 요구사항

- Rust 1.70 이상
- Git

### 빌드

```bash
git clone <repository-url>
cd ebcapture
cargo build --release
```

## 사용법

### 1. 프로그램 실행

```bash
# 개발 모드
cargo run

# 또는 빌드된 실행 파일
./target/release/ebcapture

# 관리자 권한으로 실행 (권장)
# Windows: "관리자 권한으로 실행" 선택 후 위 명령어 실행
```

### 2. 사용 과정

1. **프로그램 시작**: 전자책 리더를 먼저 실행해주세요
2. **프로그램 선택**: 감지된 전자책 프로그램 목록에서 선택
3. **페이지 수 입력**: 캡쳐할 페이지 수 입력 (1-999)
4. **캡쳐 시작**: 3초 카운트다운 후 자동 캡쳐 시작
5. **PDF 생성**: 캡쳐 완료 후 자동으로 PDF 생성

### 3. 출력 파일

- **개별 이미지**: `page_001.png`, `page_002.png`, ...
- **통합 PDF**: `captured_book_YYYYMMDD_HHMMSS.pdf`

## 예시 실행

```
=== EBook 캡쳐 프로그램 v1.0 ===

✅ 시스템 환경 검사 완료

📚 전자책 프로그램 후보:
1. Adobe Digital Editions (PID: 1234)

💻 기타 실행 중인 프로그램:
2. 알라딘 전자책 뷰어 (PID: 5678)
3. 기타 프로그램들...

번호를 입력하세요 (1-10): 2
선택된 프로그램: 알라딘 전자책 뷰어

캡쳐할 페이지 수를 입력하세요 (1-999): 10
캡쳐할 페이지 수: 10

출력 디렉토리: captured_book_20241201_143022

캡쳐를 시작합니다...
3... 2... 1... 시작!

📸 페이지 1/10 캡쳐 중...
📸 페이지 2/10 캡쳐 중...
...
✅ 모든 페이지 캡쳐 완료

🎉 캡쳐가 완료되었습니다!
📁 PDF 파일: captured_book_20241201_143022/captured_book_20241201_143022.pdf
```

## 환경 설정

### Windows

- **관리자 권한 실행 권장**: 윈도우 활성화 제한을 우회하기 위해
- 특별한 추가 설정 불필요

### macOS

- **화면 캡쳐 권한**: 시스템 환경설정 > 보안 및 개인정보보호 > 개인정보보호 > 화면 기록에서 프로그램 허용

## 문제 해결

### 전자책 프로그램이 감지되지 않는 경우

1. 전자책 프로그램이 실행되어 있는지 확인
2. 프로그램 창이 최소화되어 있지 않은지 확인
3. "기타 실행 중인 프로그램" 목록에서 해당 프로그램을 찾아 선택

### 🚨 "윈도우 활성화 실패" 에러

**에러 메시지**: `화면 캡쳐에 실패했습니다: 윈도우 활성화 실패`

**원인**: Windows 보안 정책에 의해 다른 프로그램 창을 자동으로 활성화하는 것이 차단됨

**해결 방법**:
1. **관리자 권한으로 실행** (가장 효과적)
   ```bash
   # 명령 프롬프트를 "관리자 권한으로 실행"한 후
   cd ebcapture
   cargo run
   ```

2. **수동 창 활성화**
   - 에러 발생 시 프로그램에서 안내 메시지가 표시됩니다
   - 수동으로 전자책 프로그램 창을 클릭하여 활성화
   - Enter 키를 눌러 계속 진행

3. **대안적 방법**
   - UAC 설정 조정 (권장하지 않음)
   - 전자책 프로그램을 같은 권한 레벨로 실행

### 캡쳐가 실패하는 경우

1. 화면 캡쳐 권한이 있는지 확인 (macOS)
2. 다른 프로그램이 화면을 가리고 있지 않은지 확인
3. 전자책 프로그램이 전체화면 모드가 아닌지 확인

### 페이지 넘김이 제대로 되지 않는 경우

1. 전자책 프로그램이 포커스를 가지고 있는지 확인
2. 키보드 단축키가 다른 경우 수동으로 넘겨주세요

## 개발 상태

### 구현 완료

- [x] CLI 인터페이스
- [x] 윈도우 감지 (Windows)
- [x] 화면 캡쳐 (전체 화면)
- [x] 키보드 시뮬레이션
- [x] PDF 생성 (기본)
- [x] 에러 처리
- [x] 윈도우 활성화 오류 대응

### TODO

- [ ] 윈도우별 영역 캡쳐
- [ ] macOS 완전 지원
- [ ] PDF 이미지 삽입 (현재 플레이스홀더)
- [ ] GUI 인터페이스
- [ ] 배치 처리
- [ ] OCR 기능

## 라이선스

이 프로젝트는 교육 목적으로 제작되었습니다. 전자책의 저작권을 존중하고 합법적인 용도로만 사용해주세요.

## 기여

이슈나 풀 리퀘스트를 환영합니다!

## 버전 정보

- **v1.0**: 기본 캡쳐 및 PDF 생성 기능
- **v1.1**: 윈도우 활성화 오류 대응 및 사용자 경험 개선 