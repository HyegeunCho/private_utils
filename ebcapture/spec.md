# EBook 캡쳐 프로그램 스펙 (v1.0)

## 1. 프로젝트 개요

### 1.1 목적
- **주요 목적**: Windows/Mac 환경에서 전자책 리더 프로그램의 화면을 자동으로 캡쳐하여 이미지 및 PDF 파일로 변환하는 도구 개발
- **대상 플랫폼**: 알라딘, 리디북스, Yes24 등의 전자책 리더 애플리케이션
- **출력 형식**: 개별 이미지 파일 + 통합 PDF 문서

### 1.2 핵심 가치 제안
- 전자책 콘텐츠의 백업 및 보관
- 오프라인 환경에서의 접근성 향상
- 다양한 디바이스 간 호환성 제공

## 2. 기능 요구사항

### 2.1 핵심 기능
- **F001**: 시스템에서 실행 중인 전자책 프로그램 자동 감지 및 선택
- **F002**: 선택된 프로그램 창의 화면 영역 자동 인식
- **F003**: 지정된 페이지 수만큼 자동 캡쳐 수행
- **F004**: 페이지 넘김 자동화 (키보드 입력 시뮬레이션)
- **F005**: 캡쳐된 이미지들을 단일 PDF로 통합

### 2.2 사용자 인터페이스 요구사항
- **UI001**: CLI 기반 인터페이스 제공
- **UI002**: 실행 중인 프로그램 목록을 번호와 함께 표시
- **UI003**: 사용자 입력 검증 및 에러 메시지 제공
- **UI004**: 진행 상황 실시간 표시 (예: "페이지 3/50 캡쳐 중...")

## 3. 기술 요구사항

### 3.1 시스템 요구사항
- **플랫폼**: Windows 10+ / macOS 10.14+
- **언어**: Rust
- **의존성**: 
  - 화면 캡쳐: `screenshot` 또는 `scrap` crate
  - PDF 생성: `printpdf` 또는 `pdf-writer` crate
  - 키보드 입력: `enigo` 또는 `autopilot` crate
  - 윈도우 관리: `winapi` (Windows) / `cocoa` (macOS)

### 3.2 성능 요구사항
- **캡쳐 속도**: 페이지당 1-2초 이내
- **메모리 사용량**: 동시에 메모리에 보관할 이미지 수 제한 (예: 최대 10페이지)
- **파일 크기**: PDF 압축을 통한 최적화

## 4. 프로그램 실행 플로우

### 4.1 초기화 단계
```
1. 프로그램 시작
2. 시스템 환경 검사 (OS, 권한 등)
3. 필요 라이브러리 로드
```

### 4.2 설정 단계
```
4. 실행 중인 윈도우 목록 스캔
5. 전자책 프로그램 후보 필터링
6. 사용자에게 선택 목록 제시
   - 입력: 프로그램 번호 (1-N)
   - 검증: 유효한 번호인지 확인
7. 선택된 프로그램 창 활성화 및 포커스
```

### 4.3 캡쳐 설정
```
8. 대상 페이지 수 입력 요청
   - 입력: 양의 정수 (1-999)
   - 검증: 숫자 형식 및 범위 확인
9. 캡쳐 영역 자동 감지 또는 수동 설정
10. 캡쳐 시작 전 3초 대기 (사용자 준비 시간)
```

### 4.4 캡쳐 실행
```
11. FOR i = 1 TO 페이지수:
    a. 현재 화면 캡쳐
    b. 이미지 파일로 임시 저장 (page_XXX.png)
    c. 진행 상황 출력
    d. 오른쪽 화살표 키 전송
    e. 페이지 로딩 대기 (1-2초)
12. ENDFOR
```

### 4.5 후처리
```
13. 모든 이미지를 단일 PDF로 병합
14. 임시 이미지 파일 정리
15. 완료 메시지 및 저장 위치 안내
```

## 5. 입력/출력 명세

### 5.1 사용자 입력
| 입력 항목 | 데이터 타입 | 범위/형식 | 예시 | 필수여부 |
|-----------|------------|-----------|------|----------|
| 프로그램 선택 | 정수 | 1-N | 2 | 필수 |
| 페이지 수 | 정수 | 1-999 | 50 | 필수 |
| 출력 경로 | 문자열 | 유효한 경로 | ./output/ | 선택 |

### 5.2 출력 파일
| 파일 타입 | 명명 규칙 | 예시 |
|-----------|-----------|------|
| 개별 이미지 | page_XXX.png | page_001.png, page_002.png |
| 통합 PDF | captured_book_YYYYMMDD_HHMMSS.pdf | captured_book_20241201_143022.pdf |

## 6. 예외 상황 및 에러 처리

### 6.1 시스템 레벨 에러
- **E001**: 전자책 프로그램이 실행되지 않은 경우
  - 대응: 에러 메시지 출력 후 프로그램 종료
- **E002**: 화면 캡쳐 권한이 없는 경우 (macOS)
  - 대응: 권한 설정 가이드 제공
- **E003**: 디스크 공간 부족
  - 대응: 필요 용량 안내 및 정리 권장

### 6.2 실행 중 에러
- **E004**: 대상 프로그램이 중간에 종료된 경우
  - 대응: 현재까지 캡쳐된 내용 저장 후 종료
- **E005**: 캡쳐 실패 (화면 변화 없음 등)
  - 대응: 재시도 로직 (최대 3회)

## 7. 성공 기준

### 7.1 기능적 기준
- [ ] 지원 대상 전자책 프로그램에서 정상 동작
- [ ] 지정된 페이지 수만큼 정확히 캡쳐
- [ ] 생성된 PDF가 정상적으로 열리고 읽기 가능
- [ ] 페이지 순서가 올바르게 유지

### 7.2 비기능적 기준
- [ ] 50페이지 캡쳐 시 5분 이내 완료
- [ ] 메모리 사용량 500MB 이하 유지
- [ ] 사용자 입력 오류에 대한 명확한 피드백 제공

## 8. 향후 확장 계획

### 8.1 Phase 2 기능
- GUI 인터페이스 추가
- 배치 처리 (여러 책 동시 캡쳐)
- OCR 기능 통합
- 클라우드 저장소 연동

### 8.2 최적화 계획
- 이미지 압축 알고리즘 개선
- 다중 스레드 처리
- 캐시 메커니즘 구현 